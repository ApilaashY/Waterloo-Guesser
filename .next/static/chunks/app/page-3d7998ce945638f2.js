(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3299:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>u});var n=l(5155),s=l(2115),o=l(4239),a=l(1524);function i(){let[e,t]=(0,s.useState)(!1),[l,i]=(0,s.useState)(!1),[u,r]=(0,s.useState)(0),[d,c]=(0,s.useState)([]),[h,x]=(0,s.useState)(0),[f,m]=(0,s.useState)({}),[b,p]=(0,s.useState)(!1),[g,j]=(0,s.useState)(null),[v,y]=(0,s.useState)(null),[w,C]=(0,s.useState)(null),[N,S]=(0,s.useState)(null),[k,M]=(0,s.useState)(.8),R=(0,s.useRef)(!1),E=(0,s.useRef)(!1);function O(){E.current||(E.current=!0,fetch("/api/getPhoto",{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({previousCodes:d})}).then(e=>e.json()).then(e=>{d.includes(e.id)?c([e.id]):c([...d,e.id]),m(e),j(null),y(null),C(null),S(null),E.current=!1}))}let T=(0,s.useRef)(!1),_=(0,s.useRef)(null);return(0,s.useEffect)(()=>{b||(p(!0),O())},[]),(0,n.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-50 overflow-hidden",children:[(0,n.jsx)("button",{className:"absolute top-4 right-4 z-50 px-4 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700",onClick:()=>t(e=>!e),children:e?"Back to Game":"Add Location"}),e?(0,n.jsx)(a.default,{}):(0,n.jsxs)("div",{className:"relative flex flex-col items-center justify-center w-full h-full",children:[(0,n.jsx)("div",{className:"absolute top-4 left-4",children:(0,n.jsxs)("h1",{className:"text-xl font-bold text-gray-800 bg-white/80 rounded px-4 py-2 shadow",children:["Points: ",u]})}),(0,n.jsx)("div",{className:"absolute top-4 right-4 z-50",children:(0,n.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700",onClick:()=>t(e=>!e),children:e?"Back to Game":"Add Location"})}),(0,n.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,n.jsxs)("div",{ref:_,className:"flex items-center justify-center w-full h-full max-w-4xl max-h-[80vh] mx-auto my-auto bg-white rounded shadow-lg overflow-hidden relative",children:[(0,n.jsx)(o.A,{xCoor:g,yCoor:v,setXCoor:null==w&&null==N?j:()=>{},setYCoor:null==w&&null==N?y:()=>{},xRightCoor:w,yRightCoor:N,disabled:null!=w&&null!=N,aspectRatio:896/683*.7}),(0,n.jsx)("div",{className:"absolute top-4 right-4 z-50",children:(0,n.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded shadow hover:bg-green-700",onClick:()=>null==w||null==N?void(!T.current&&(T.current=!0,fetch("/api/validateCoordinate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({xCoor:g,yCoor:v,id:f.id})}).then(e=>e.json()).then(e=>{C(e.xCoor),S(e.yCoor),r(u+e.points),x(h+1),T.current=!1,function(){let e=_.current;if(!e||null==g||null==v||null==w||null==N)return;let t=e.clientWidth,l=e.clientHeight,n=(Math.min(g,w)-.05)*t,s=(Math.min(v,N)-.05)*l,o=(Math.max(g,w)+.05)*t,a=(Math.max(v,N)+.05)*l,i=(o-n)/t,u=(a-s)/l,r=1/Math.max(i,u);i>u?s=(s+a)/2-l/r/2:n=(n+o)/2-t/r/2,e.scrollTo({left:Math.max(0,-n*r),top:Math.max(0,-s*r),behavior:"smooth"})}()}))):O(),children:null==w||null==N?"Submit":"Next"})})]})}),(0,n.jsx)("div",{className:"absolute bottom-4 right-4 flex justify-end items-start w-full",style:{pointerEvents:"none"},children:(0,n.jsx)("img",{className:"rounded shadow",src:f.image,style:{opacity:k,maxWidth:400,marginRight:20,pointerEvents:"none"},onMouseEnter:()=>{R.current=!0,M(1)},onMouseLeave:()=>{R.current=!1,setTimeout(()=>{R.current||M(.8)},5e3)}})})]})]})}function u(){return(0,n.jsx)(i,{})}},3664:(e,t,l)=>{Promise.resolve().then(l.bind(l,3299))}},e=>{e.O(0,[472,524,441,964,358],()=>e(e.s=3664)),_N_E=e.O()}]);