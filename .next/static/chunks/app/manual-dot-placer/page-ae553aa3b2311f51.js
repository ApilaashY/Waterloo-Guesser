(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[581],{5210:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var i=n(5155),o=n(2115),l=n(7472),r=n(6766);let a=e=>{let{dot:t,index:n,buildingFloors:l,handleDotMouseDown:r,handleDeleteDot:a}=e,[d,s]=(0,o.useState)(!1);return(0,i.jsxs)("div",{style:{position:"absolute",top:"".concat(100*t.y,"%"),left:"".concat(100*t.x,"%"),width:21,height:21,borderRadius:"50%",background:"yellow",border:"2px solid #888",display:"flex",alignItems:"center",justifyContent:"center",transform:"translate(-50%, -50%)",zIndex:10,fontWeight:"bold",color:"#222",fontSize:12,cursor:"grab",userSelect:"none"},title:t.building,onMouseDown:e=>r(e,n),onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[t.building,(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),a(n)},style:{position:"absolute",top:-10,right:-10,width:18,height:18,borderRadius:"50%",background:"#f44",color:"#fff",border:"none",fontSize:12,cursor:"pointer",zIndex:20},title:"Delete dot",children:"\xd7"}),d&&l[t.building]&&(0,i.jsx)("div",{style:{position:"absolute",top:"50%",left:"110%",transform:"translateY(-50%)",background:"#fff",border:"1px solid #ccc",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",padding:"6px 12px",minWidth:"60px",zIndex:30,pointerEvents:"auto",whiteSpace:"nowrap"},children:l[t.building].map(e=>(0,i.jsx)("button",{style:{display:"block",width:"100%",margin:"2px 0",padding:"4px 8px",fontSize:"12px",background:"#eee",border:"1px solid #bbb",borderRadius:"4px",cursor:"pointer",textAlign:"left"},onClick:()=>window.open("/clean_floorplans/".concat(e.filename),"_blank"),children:e.floor.replace("FLR","")},e.filename))})]})};function d(e){let{show:t=!0}=e,[n,d]=(0,o.useState)([]),[s,u]=(0,o.useState)(null),[c,p]=(0,o.useState)(""),[h,f]=(0,o.useState)({});(0,o.useEffect)(()=>{fetch("/api/floorplans").then(e=>e.json()).then(e=>{let t={};e.floorplans&&e.floorplans.forEach(e=>{e.building&&"UNKNOWN"!==e.building&&(t[e.building]||(t[e.building]=[]),t[e.building].push({filename:e.filename,floor:e.floor}))}),f(t)})},[]);let g=(0,o.useRef)(null),x=(0,o.useRef)(null);function b(e,t){e.stopPropagation(),g.current=t;let i=e.currentTarget.parentElement.getBoundingClientRect(),o=(e.clientX-i.left)/i.width,l=(e.clientY-i.top)/i.height;x.current={x:o-n[t].x,y:l-n[t].y},document.addEventListener("mousemove",m),document.addEventListener("mouseup",y)}function m(e){if(null===g.current||null===x.current)return;let t=document.getElementById("dot-map-container");if(!t)return;let n=t.getBoundingClientRect(),i=(e.clientX-n.left)/n.width-x.current.x,o=(e.clientY-n.top)/n.height-x.current.y;d(e=>e.map((e,t)=>t===g.current?{...e,x:Math.max(0,Math.min(1,i)),y:Math.max(0,Math.min(1,o))}:e))}function y(){g.current=null,x.current=null,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",y)}function v(e){d(t=>t.filter((t,n)=>n!==e))}return(0,i.jsxs)("div",{style:{width:"100vw",height:"100vh",background:"#f8f8f8",display:t?void 0:"none"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",margin:8},children:[(0,i.jsx)("h2",{style:{margin:0,marginRight:16},children:"Manual Building Dot Placer"}),(0,i.jsx)("button",{onClick:function(){let e=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download="manual_building_lookup.json",i.click(),URL.revokeObjectURL(t)},style:{fontSize:16,padding:"8px 16px"},children:"Export JSON"}),(0,i.jsxs)("span",{style:{marginLeft:16,color:"#888"},children:["Dots placed: ",n.length]})]}),(0,i.jsx)("div",{id:"dot-map-container",style:{position:"relative",width:"80vw",height:"80vh",margin:"auto"},children:(0,i.jsx)(l.GT,{children:(0,i.jsx)(l.WZ,{children:(0,i.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},onContextMenu:function(e){e.preventDefault();let t=e.currentTarget.querySelector("img");if(!t)return;let n=t.getBoundingClientRect(),i=(e.clientX-n.left)/n.width,o=(e.clientY-n.top)/n.height;i>=0&&i<=1&&o>=0&&o<=1&&(u({x:i,y:o}),p(""))},children:[(0,i.jsx)(r.default,{src:"/uw campus map.png",alt:"Campus Map",width:896,height:683,style:{width:"100%",height:"100%",objectFit:"contain",display:"block"}}),n.map((e,t)=>(0,i.jsx)(a,{dot:e,index:t,buildingFloors:h,handleDotMouseDown:b,handleDeleteDot:v},t)),s&&(0,i.jsxs)("div",{style:{position:"absolute",top:"".concat(100*s.y,"%"),left:"".concat(100*s.x,"%"),transform:"translate(-50%, -120%)",zIndex:20,background:"#fff",border:"1px solid #ccc",borderRadius:8,padding:12,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",minWidth:120},children:[(0,i.jsxs)("div",{style:{marginBottom:8},children:[(0,i.jsx)("label",{children:"Building Code: "}),(0,i.jsx)("input",{type:"text",value:c,onChange:e=>p(e.target.value),style:{width:60,fontWeight:"bold"},autoFocus:!0})]}),(0,i.jsx)("button",{onClick:function(){c.trim()&&s&&(d([...n,{x:s.x,y:s.y,building:c.trim()}]),u(null),p(""))},style:{marginRight:8},children:"Save"}),(0,i.jsx)("button",{onClick:()=>u(null),children:"Cancel"})]})]})})})})]})}function s(){return(0,i.jsx)(d,{})}},8758:(e,t,n)=>{Promise.resolve().then(n.bind(n,5210))}},e=>{e.O(0,[537,441,964,358],()=>e(e.s=8758)),_N_E=e.O()}]);