(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3166:(e,t,l)=>{Promise.resolve().then(l.bind(l,3299))},3299:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>r});var n=l(5155),s=l(2115),o=l(6766),a=l(4239),i=l(6962);function u(){let[e,t]=(0,s.useState)(!1),[l,u]=(0,s.useState)(0),[r,d]=(0,s.useState)([]),[c,h]=(0,s.useState)(0),[x,f]=(0,s.useState)({}),[m,b]=(0,s.useState)(!1),[p,g]=(0,s.useState)(null),[j,v]=(0,s.useState)(null),[y,w]=(0,s.useState)(null),[C,N]=(0,s.useState)(null),[S,k]=(0,s.useState)(.8),M=(0,s.useRef)(!1),R=(0,s.useRef)(!1);function E(){R.current||(R.current=!0,fetch("/api/getPhoto",{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({previousCodes:r})}).then(e=>e.json()).then(e=>{r.includes(e.id)?d([e.id]):d([...r,e.id]),f(e),g(null),v(null),w(null),N(null),R.current=!1}))}let O=(0,s.useRef)(!1),T=(0,s.useRef)(null);return(0,s.useEffect)(()=>{m||(b(!0),E())},[m]),(0,n.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-50 overflow-hidden",children:[(0,n.jsx)("button",{className:"absolute top-4 right-4 z-50 px-4 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700",onClick:()=>t(e=>!e),children:e?"Back to Game":"Add Location"}),e?(0,n.jsx)(i.default,{}):(0,n.jsxs)("div",{className:"relative flex flex-col items-center justify-center w-full h-full",children:[(0,n.jsx)("div",{className:"absolute top-4 left-4",children:(0,n.jsxs)("h1",{className:"text-xl font-bold text-gray-800 bg-white/80 rounded px-4 py-2 shadow",children:["Points: ",l]})}),(0,n.jsx)("div",{className:"absolute top-4 right-4 z-50",children:(0,n.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700",onClick:()=>t(e=>!e),children:e?"Back to Game":"Add Location"})}),(0,n.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,n.jsxs)("div",{ref:T,className:"flex items-center justify-center w-full h-full max-w-4xl max-h-[80vh] mx-auto my-auto bg-white rounded shadow-lg overflow-hidden relative",children:[(0,n.jsx)(a.A,{xCoor:p,yCoor:j,setXCoor:null==y&&null==C?g:()=>{},setYCoor:null==y&&null==C?v:()=>{},xRightCoor:y,yRightCoor:C,disabled:null!=y&&null!=C,aspectRatio:896/683*.7}),(0,n.jsx)("div",{className:"absolute top-4 right-4 z-50",children:(0,n.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded shadow hover:bg-green-700",onClick:()=>null==y||null==C?void(!O.current&&(O.current=!0,fetch("/api/validateCoordinate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({xCoor:p,yCoor:j,id:x.id})}).then(e=>e.json()).then(e=>{w(e.xCoor),N(e.yCoor),u(l+e.points),h(c+1),O.current=!1,function(){let e=T.current;if(!e||null==p||null==j||null==y||null==C)return;let t=e.clientWidth,l=e.clientHeight,n=(Math.min(p,y)-.05)*t,s=(Math.min(j,C)-.05)*l,o=(Math.max(p,y)+.05)*t,a=(Math.max(j,C)+.05)*l,i=(o-n)/t,u=(a-s)/l,r=1/Math.max(i,u);i>u?s=(s+a)/2-l/r/2:n=(n+o)/2-t/r/2,e.scrollTo({left:Math.max(0,-n*r),top:Math.max(0,-s*r),behavior:"smooth"})}()}))):E(),children:null==y||null==C?"Submit":"Next"})})]})}),(0,n.jsx)("div",{className:"absolute bottom-4 right-4 flex justify-end items-start w-full",style:{pointerEvents:"none"},children:x.image&&(0,n.jsx)(o.default,{className:"rounded shadow",src:x.image,alt:"Campus location",width:400,height:300,style:{opacity:S,marginRight:20,pointerEvents:"none"},onMouseEnter:()=>{M.current=!0,k(1)},onMouseLeave:()=>{M.current=!1,setTimeout(()=>{M.current||k(.8)},5e3)}})})]})]})}function r(){return(0,n.jsx)(u,{})}}},e=>{e.O(0,[537,962,441,964,358],()=>e(e.s=3166)),_N_E=e.O()}]);